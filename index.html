<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chào mừng</title> <!-- Updated title -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FontAwesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Custom font for better aesthetics */
        body {
            font-family: 'Inter', sans-serif;
            /* Changed background to support aurora effect from music.html */
            background: #0d1a2a; /* Dark base color */
            display: flex;
            /* Center the container horizontally */
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 15px; /* Reduced from 20px */
            box-sizing: border-box;
            color: #ecf0f1; /* Default light text color for body */
            position: relative; /* For positioning aurora layers */
            /* Đã loại bỏ overflow: hidden; để cho phép cuộn trang */
        }

        /* Aurora Borealis Effect - Copied from music.html */
        .aurora-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none; /* Allow clicks to pass through */
            z-index: -1; /* Place behind content */
            background: transparent;
            overflow: hidden; /* Keep hidden for aurora layers to prevent inner scroll */
        }

        .aurora-layer {
            position: absolute;
            background: linear-gradient(to bottom,
                rgba(52, 152, 219, 0.3), /* Blue from active playlist item */
                rgba(46, 204, 113, 0.3)  /* Green from active playlist item */
            );
            border-radius: 50%;
            filter: blur(80px); /* Reverted to original 80px */
            opacity: 0.5; /* Keep it visible but static */
            animation: auroraMovement 20s infinite alternate ease-in-out; /* Re-enabled animation */
        }

        .aurora-layer:nth-child(1) {
            width: 600px; /* Reverted to original 600px */
            height: 600px; /* Reverted to original 600px */
            top: 10%;
            left: 15%;
            background: linear-gradient(to bottom, rgba(52, 152, 219, 0.4), rgba(46, 204, 113, 0.4));
        }

        .aurora-layer:nth-child(2) {
            width: 700px; /* Reverted to original 700px */
            height: 700px; /* Reverted to original 700px */
            top: 50%;
            left: 70%;
            background: linear-gradient(to top, rgba(0, 200, 200, 0.4), rgba(0, 150, 150, 0.4)); /* Teal tones */
        }

        .aurora-layer:nth-child(3) {
            width: 500px; /* Reverted to original 500px */
            height: 500px; /* Reverted to original 500px */
            top: 80%;
            left: 30%;
            background: linear-gradient(to right, rgba(70, 130, 180, 0.3), rgba(60, 179, 113, 0.3)); /* SteelBlue to MediumSeaGreen */
        }

        .aurora-layer:nth-child(4) {
            width: 400px; /* Reverted to original 400px */
            height: 400px; /* Reverted to original 400px */
            top: 20%;
            left: 80%;
            background: linear-gradient(to left, rgba(135, 206, 250, 0.3), rgba(127, 255, 212, 0.3)); /* LightSkyBlue to Aquamarine */
        }

        @keyframes auroraMovement {
            0% {
                transform: translate(0, 0) scale(1);
                opacity: 0.5;
            }
            25% {
                transform: translate(20px, -30px) scale(1.05); /* Reverted to original */
                opacity: 0.7;
            }
            50% {
                transform: translate(-10px, 40px) scale(0.95); /* Reverted to original */
                opacity: 0.6;
            }
            75% {
                transform: translate(30px, -20px) scale(1.03); /* Reverted to original */
                opacity: 0.8;
            }
            100% {
                transform: translate(0, 0) scale(1);
                opacity: 0.5;
            }
        }

        /* Page Transition Animations - Changed to Fade In/Out with subtle timing */
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
            }
            to {
                opacity: 0;
            }
        }

        /* Initial state for page content wrapper to prevent flicker */
        #pageContentWrapper {
            opacity: 0; /* Start hidden */
        }

        .page-transition-in {
            animation: fadeIn 0.5s ease-out forwards; /* Smoother ease-out */
        }

        .page-transition-out {
            animation: fadeOut 0.5s ease-in forwards; /* Smoother ease-in */
        }


        .container {
            background-color: rgba(44, 62, 80, 0.05); /* Made 95% transparent (5% opacity) */
            border-radius: 12px; /* Reduced from 16px */
            box-shadow: 0 9px 22px rgba(0, 0, 0, 0.4); /* Reduced from 0 12px 30px */
            padding: 22px; /* Reduced from 30px */
            max-width: 375px; /* Reduced from 500px */
            width: 100%;
            text-align: center;
            border: 1px solid rgba(61, 90, 115, 0.1); /* Subtle border for depth with transparency */
            backdrop-filter: blur(7px); /* Reduced from 10px */
            -webkit-backdrop-filter: blur(7px); /* For Safari */
            transition: all 0.5s cubic-bezier(0.25, 0.8, 0.25, 1); /* Smooth transition for any changes */
            z-index: 1; /* Ensure container is above aurora effect */
            position: relative; /* For positioning elements inside */
        }
        /* New class for expanded container on search focus */
        .container.expanded-search {
            max-width: 525px; /* Reduced from 700px */
            padding: 30px; /* Reduced from 40px */
            box-shadow: 0 11px 30px rgba(0, 0, 0, 0.5); /* Reduced from 0 15px 40px */
            will-change: max-width, padding, box-shadow; /* Add will-change here for optimization */
        }
        h1 {
            font-size: 1.875rem; /* Reduced from 2.5rem */
            font-weight: 700;
            color: #ecf0f1;
            margin-bottom: 1.5rem; /* Reduced from 2rem */
            text-shadow: 0 1.5px 4.5px rgba(0,0,0,0.4); /* Reduced from 0 2px 6px */
        }

        /* Updated CSS for the glowing time (reduced intensity to ~15%) */
        @keyframes whiteGlowPulse {
            0% {
                text-shadow: 0 0 0.375px #fff, 0 0 0.75px #fff, 0 0 1.125px #fff; /* Very subtle glow */
            }
            50% {
                text-shadow: 0 0 0.75px #fff, 0 0 1.5px #fff, 0 0 2.25px #fff; /* Slightly more visible at peak */
            }
            100% {
                text-shadow: 0 0 0.375px #fff, 0 0 0.75px #fff, 0 0 1.125px #fff; /* Back to very subtle glow */
            }
        }

        .glowing-title {
            animation: whiteGlowPulse 2s infinite alternate ease-in-out;
        }

        /* Optimized CSS for aura/halo hover glow on tool cards (blue-green) */
        @keyframes auraCardGlow {
            from {
                box-shadow: 0 4.5px 11.25px rgba(0, 0, 0, 0.3); /* Reduced shadow */
            }
            to {
                box-shadow: 0 4.5px 18.75px rgba(0, 0, 0, 0.5), /* Stronger base shadow */
                            0 0 18.75px rgba(52, 152, 219, 0.8), /* More intense blue inner glow */
                            0 0 30px rgba(46, 204, 113, 0.6); /* Larger, more diffused green outer glow */
            }
        }

        .grid-cols-2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.125rem; /* Reduced from 1.5rem */
        }
        .tool-card {
            background-color: rgba(52, 73, 94, 0.08); /* Made 92% transparent (8% opacity) */
            border-radius: 9px; /* Reduced from 12px */
            padding: 15px; /* Reduced from 20px */
            box-shadow: 0 4.5px 11.25px rgba(0, 0, 0, 0.3); /* Softer shadow */
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); /* Springy transition */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-decoration: none; /* Remove underline for links */
            color: inherit; /* Inherit text color */
            border: 1px solid rgba(74, 98, 122, 0.1); /* Subtle border */
        }
        .tool-card:hover {
            transform: translateY(-7.5px) scale(1.075); /* Increased lift and scale for a more pronounced effect */
            background-color: rgba(61, 90, 115, 0.15); /* Slightly lighter on hover, still mostly transparent */
            animation: auraCardGlow 0.5s forwards; /* Apply aura glow on hover */
            z-index: 2; /* Ensure the hovered card is above others */
            position: relative; /* Needed for z-index to work */
        }
        .tool-card:active {
            transform: translateY(0) scale(0.9625); /* Gentle press effect */
            box-shadow: 0 3.75px 7.5px rgba(0, 0, 0, 0.2);
        }
        .tool-card i {
            font-size: 2.25rem; /* Reduced from 3rem */
            color: #3498db; /* Blue accent for icons */
            margin-bottom: 0.75rem; /* Reduced from 1rem */
            /* Added transform for smooth scaling */
            transition: color 0.3s ease, text-shadow 0.3s ease, transform 0.3s ease;
            text-shadow: 0 0 5.25px rgba(52, 152, 219, 0.6); /* Subtle glow for icons, slightly increased */
        }
        .tool-card:hover i {
            font-size: 2.625rem; /* Make icon larger on hover */
            color: #2ecc71; /* Green accent on hover */
            text-shadow: 0 0 11.25px rgba(46, 204, 113, 1), 0 0 18.75px rgba(46, 204, 113, 0.7); /* Even stronger green glow */
            transform: scale(1.075); /* Slightly scale the icon itself */
        }
        /* New style for text-based icons */
        .tool-icon-text {
            font-size: 1.875rem; /* Reduced from 2.5rem */
            font-weight: bold; /* Make the text bold */
            color: #3498db; /* Blue accent, consistent with other icons */
            margin-bottom: 0.75rem; /* Keep consistent margin */
            display: flex; /* Use flex to center text vertically if needed */
            align-items: center;
            justify-content: center;
            height: 2.25rem; /* Keep fixed height to align with original icons */
            width: 100%; /* Take full width to center text */
            /* Added transform for smooth scaling */
            transition: color 0.3s ease, text-shadow 0.3s ease, transform 0.3s ease;
            text-shadow: 0 0 5.25px rgba(52, 152, 219, 0.6); /* Subtle glow for text icons, slightly increased */
        }
        .tool-card:hover .tool-icon-text {
            font-size: 2.25rem; /* Make text icon larger on hover */
            color: #2ecc71; /* Green accent on hover */
            text-shadow: 0 0 11.25px rgba(46, 204, 113, 1), 0 0 18.75px rgba(46, 204, 113, 0.7); /* Even stronger green glow */
            transform: scale(1.075); /* Slightly scale the text icon itself */
        }

        .tool-card h2 {
            font-size: 0.975rem; /* Slightly larger heading */
            font-weight: 600;
            color: #ecf0f1;
            margin-bottom: 0.375rem;
        }
        .tool-card p {
            font-size: 0.7125rem; /* Slightly larger description */
            color: #bdc3c7;
            line-height: 1.4;
        }

        /* Music Player Floating Button */
        .music-player-floating-button-wrapper {
            position: fixed; /* Fixed position relative to the viewport */
            bottom: 22px; /* 30px from the bottom */
            left: 22px; /* 30px from the left */
            z-index: 1000; /* Ensure it's above all other content */
            display: flex;
            align-items: flex-end; /* Align tooltip to the bottom of the button */
            justify-content: flex-start; /* Align tooltip to the left of the button */
        }

        .music-player-floating-button {
            background: rgba(52, 152, 219, 0.08); /* Made 92% transparent */
            color: white;
            width: 45px; /* Smaller size */
            height: 45px; /* Smaller size */
            border-radius: 50%; /* Circular button */
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.125rem; /* Icon size */
            box-shadow: 0 3.75px 11.25px rgba(52, 152, 219, 0.08); /* Adjusted shadow transparency */
            transition: all 0.35s cubic-bezier(0.25, 0.8, 0.25, 1);
            position: relative; /* For tooltip positioning */
            z-index: 1; /* Ensure button is above tooltip when active */
            border: 1px solid rgba(52, 152, 219, 0.15); /* Subtle border for depth with transparency */
        }

        .music-player-floating-button:hover {
            background: rgba(52, 152, 219, 0.15); /* Slightly more opaque on hover */
            transform: translateY(-2.25px) scale(1.0375); /* Gentle lift and slight scale */
            box-shadow: 0 6px 15px rgba(52, 152, 219, 0.2); /* Adjusted shadow transparency */
        }

        .music-player-floating-button:active {
            transform: translateY(0) scale(0.9625); /* Gentle press effect */
            box-shadow: 0 1.5px 6px rgba(52, 152, 219, 0.05); /* Adjusted shadow transparency */
            background: rgba(36, 113, 163, 0.1); /* Slightly darker on active */
        }

        /* Re-enabled Pulse effect for the music button when playing */
        @keyframes pulseMusicButton {
            0% {
                box-shadow: 0 3.75px 11.25px rgba(52, 152, 219, 0.08); /* Adjusted shadow transparency */
            }
            50% {
                box-shadow: 0 0 18.75px rgba(52, 152, 219, 0.2), 0 0 30px rgba(255, 255, 255, 0.1); /* Adjusted glow transparency */
            }
            100% {
                box-shadow: 0 3.75px 11.25px rgba(52, 152, 219, 0.08); /* Adjusted shadow transparency */
            }
        }

        .music-player-floating-button.playing {
            animation: pulseMusicButton 1.5s infinite ease-in-out; /* Re-enabled animation */
        }


        /* Custom Tooltip Styles */
        .music-tooltip {
            position: absolute;
            left: 52px; /* Position to the right of the button */
            bottom: 50%; /* Vertically center with the button */
            transform: translateY(50%); /* Adjust for vertical centering */
            background-color: rgba(44, 62, 80, 0.95); /* Darker background with transparency */
            color: #ecf0f1;
            padding: 7.5px 11.25px;
            border-radius: 6px;
            box-shadow: 0 3px 11.25px rgba(0, 0, 0, 0.3);
            white-space: nowrap; /* Prevent text wrapping */
            opacity: 0; /* Hidden by default */
            visibility: hidden; /* Hidden by default */
            transition: opacity 0.3s ease, visibility 0.3s ease;
            font-size: 0.7125rem;
            pointer-events: none; /* Allow clicks to pass through */
            border: 1px solid #3d5a73; /* Subtle border */
            backdrop-filter: blur(2.25px); /* Subtle blur for the tooltip */
            -webkit-backdrop-filter: blur(2.25px); /* For Safari */
            display: flex; /* Use flexbox for layout inside tooltip */
            align-items: center; /* Vertically align items */
            gap: 7.5px; /* Space between image and text */
        }

        .music-tooltip img {
            width: 37.5px; /* Size of the album cover */
            height: 37.5px;
            border-radius: 3px; /* Slightly rounded corners for the image */
            object-fit: cover; /* Ensure the image covers the area without distortion */
            flex-shrink: 0; /* Prevent image from shrinking */
        }

        .music-tooltip-content {
            display: flex;
            flex-direction: column;
            text-align: left;
        }

        .music-tooltip-content .song-title {
            font-weight: bold;
            font-size: 0.75rem;
            color: #ecf0f1;
        }

        .music-tooltip-content .song-details {
            font-size: 0.6375rem;
            color: #bdc3c7;
        }

        .music-player-floating-button-wrapper:hover .music-tooltip {
            opacity: 1;
            visibility: visible;
        }

        /* Search Bar Styling - Made more prominent */
        .search-bar-container {
            display: flex;
            align-items: center;
            background-color: rgba(44, 62, 80, 0.05); /* Made 95% transparent */
            border: 1.5px solid rgba(52, 152, 219, 0.1); /* Blue border for prominence */
            border-radius: 9px; /* More rounded corners */
            padding: 9px 15px; /* Increased padding */
            margin-bottom: 22px; /* More space below search bar */
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4), 0 0 11.25px rgba(52, 152, 219, 0.15); /* Stronger, blue-tinted shadow */
            transition: all 0.3s ease;
            position: relative; /* For potential future animations */
            width: 60%; /* Initial width */
            margin-left: auto; /* Center the element */
            margin-right: auto; /* Center the element */
            transition: width 0.4s cubic-bezier(0.23, 1, 0.32, 1), box-shadow 0.3s ease; /* Smooth width transition */
        }

        .search-bar-container:focus-within {
            border-color: rgba(46, 204, 113, 0.2); /* Green border on focus */
            box-shadow: 0 6px 18.75px rgba(0, 0, 0, 0.5), 0 0 15px rgba(46, 204, 113, 0.25); /* Even stronger, green-tinted shadow on focus */
            transform: translateY(-2.25px); /* Slight lift on focus */
            width: 90%; /* Expand width on focus */
        }

        .search-bar-container input {
            flex-grow: 1;
            background: transparent;
            border: none;
            outline: none;
            color: #ecf0f1;
            font-size: 0.8625rem; /* Larger font size */
            padding: 3.75px 7.5px;
        }

        .search-bar-container input::placeholder {
            color: #bdc3c7;
            opacity: 0.8; /* Slightly less transparent */
        }

        .search-bar-container .search-icon {
            color: #bdc3c7;
            font-size: 1.125rem; /* Larger icon */
            margin-left: 11.25px; /* More space to the left of the icon */
        }

        /* New animations for tool cards */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(22.5px); /* Slightly more pronounced slide */
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeOutDown {
            from {
                opacity: 1;
                transform: translateY(0);
            }
            to {
                opacity: 0;
                transform: translateY(22.5px); /* Consistent slide down */
            }
        }

        .tool-card.fade-in-up {
            animation: fadeInUp 0.5s cubic-bezier(0.23, 1, 0.32, 1) forwards; /* Longer duration, different easing */
            will-change: transform, opacity; /* Hint to browser for optimization */
        }

        .tool-card.fade-out-down {
            animation: fadeOutDown 0.5s cubic-bezier(0.55, 0.055, 0.675, 0.19) forwards; /* Longer duration, different easing */
            will-change: transform, opacity; /* Hint to browser for optimization */
        }

        /* Styles for the animated placeholder text */
        .animated-placeholder-text {
            position: absolute; /* Position over the input */
            left: 15px; /* Same padding as input */
            top: 50%;
            transform: translateY(-50%);
            color: #bdc3c7; /* Reverted to original color */
            opacity: 1;
            transition: opacity 0.5s ease-in-out; /* Fade animation */
            pointer-events: none; /* Allow clicks to pass through to input */
            white-space: nowrap; /* Prevent text wrapping */
            font-size: 0.8625rem; /* Match input font size */
            z-index: 1; /* Ensure it's above the input's default placeholder */
            padding: 3.75px 0; /* Match vertical padding of input */
        }

        .animated-placeholder-text.fade-out {
            opacity: 0;
        }

        /* Responsive adjustments */
        @media (max-width: 600px) {
            .container {
                padding: 15px; /* Reduced from 20px */
            }
            .container.expanded-search {
                max-width: 95%; /* Expand max-width for mobile when search is focused */
                padding: 22px; /* Reduced from 30px */
            }
            h1 {
                font-size: 1.5rem; /* Reduced from 2rem */
                margin-bottom: 1.125rem; /* Reduced from 1.5rem */
            }
            .grid-cols-2 {
                grid-template-columns: 1fr; /* Stack on small screens */
                gap: 0.75rem; /* Reduced from 1rem */
            }
            .tool-card {
                padding: 11.25px; /* Reduced from 15px */
            }
            .tool-card i {
                font-size: 1.875rem; /* Reduced from 2.5rem */
            }
            .tool-card h2 {
                font-size: 0.825rem; /* Reduced from 1.1rem */
            }
            .tool-card p {
                font-size: 0.6375rem; /* Reduced from 0.85rem */
            }
            .search-bar-container {
                padding: 7.5px 11.25px; /* Reduced from 10px 15px */
                margin-bottom: 15px; /* Reduced from 20px */
                width: 80%; /* Adjust width for mobile */
            }
            .search-bar-container:focus-within {
                width: 95%; /* Expand width for mobile */
            }
            .search-bar-container input {
                font-size: 0.75rem; /* Reduced from 1rem */
            }
            .search-bar-container .search-icon {
                font-size: 0.9rem; /* Reduced from 1.2rem */
            }
            .animated-placeholder-text {
                font-size: 0.75rem; /* Match input font size for mobile */
            }
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">
    <div class="aurora-background">
        <div class="aurora-layer"></div>
        <div class="aurora-layer"></div>
        <div class="aurora-layer"></div>
        <div class="aurora-layer"></div>
    </div>

    <!-- Page Content Wrapper for Transitions -->
    <div id="pageContentWrapper" class="relative w-full h-full flex justify-center items-center">
        <div class="container" id="mainContainer">
            <h1 class="text-3xl font-bold text-center mb-8" id="mainTitle">
                Chào mừng, bây giờ là <span id="currentTimeDisplay" class="glowing-title"></span>.
            </h1>

            <!-- Search Bar -->
            <div class="search-bar-container">
                <span id="animatedPlaceholder" class="animated-placeholder-text"></span>
                <input type="text" id="searchInput">
                <i class="fas fa-search search-icon"></i>
            </div>

            <div class="grid-cols-2" id="toolCardsGrid">
                <!-- Tool Card 1: Đạo Hàm -->
                <a href="dao_ham.html" class="tool-card page-link" data-href="dao_ham.html">
                    <span class="tool-icon-text" id="derivativeIcon"></span>
                    <h2>Tính Đạo Hàm</h2>
                    <p>Tính đạo hàm của các hàm số phức tạp.</p>
                </a>

                <!-- Tool Card 2: Hình Học -->
                <a href="hinh_hoc.html" class="tool-card page-link" data-href="hinh_hoc.html">
                    <i class="fas fa-cube"></i>
                    <h2>Hình Học</h2>
                    <p>Tính chu vi, diện tích, thể tích các hình 2D, 3D.</p>
                </a>

                <!-- Tool Card 3: Hệ Phương Trình Tuyến Tính -->
                <a href="hpt.html" class="tool-card page-link" data-href="hpt.html">
                    <i class="fas fa-superscript"></i>
                    <h2>Hệ Phương Trình</h2>
                    <p>Giải hệ phương trình tuyến tính.</p>
                </a>

                <!-- Tool Card 4: Tỉ Số Lượng Giác -->
                <a href="luong_giac6.html" class="tool-card page-link" data-href="luong_giac6.html">
                    <i class="fas fa-wave-square"></i>
                    <h2>Tỉ Số Lượng Giác</h2>
                    <p>Tính 6 tỉ số lượng giác của một góc.</p>
                </a>

                <!-- Tool Card 5: Phương Trình Bậc Hai -->
                <a href="pt_bac_2.html" class="tool-card page-link" data-href="pt_bac_2.html">
                    <i class="fas fa-square-root-alt"></i>
                    <h2>Phương Trình Bậc Hai</h2>
                    <p>Giải và phân tích phương trình bậc hai.</p>
                </a>

                <!-- Tool Card 6: More Police Mod GTA SA -->
                <a href="moreplmod.html" class="tool-card page-link" data-href="moreplmod.html">
                    <i class="fas fa-gamepad"></i>
                    <h2>More Police Mod GTA SA</h2>
                    <p>Thông tin về bản mod cảnh sát cho GTA San Andreas.</p>
                </a>

                <!-- Tool Card 7: Chia Động Từ -->
                <a href="dongtu.html" class="tool-card page-link" data-href="dongtu.html">
                    <span class="tool-icon-text">ABC</span>
                    <h2>Chia Động Từ</h2>
                    <p>Tra cứu cách chia động từ tiếng Anh.</p>
                </a>

                <!-- Tool Card 8: Mở Gemini tức thì -->
                <a href="https://gemini.google.com" target="_blank" class="tool-card page-link" data-href="https://gemini.google.com">
                    <span class="tool-icon-text">Gemini</span> <!-- Changed to text "Gemini" -->
                    <h2>Mở Gemini tức thì</h2>
                    <p>Truy cập nhanh Gemini để trò chuyện và sáng tạo.</p>
                </a>

                <!-- Tool Card 9: Mở Copilot tức thì -->
                <a href="https://copilot.microsoft.com/" target="_blank" class="tool-card page-link" data-href="https://copilot.microsoft.com/">
                    <span class="tool-icon-text">Copilot</span> <!-- Added new item for Copilot -->
                    <h2>Mở Copilot tức thì</h2>
                    <p>Truy cập nhanh Copilot để hỗ trợ lập trình và hơn thế nữa.</p>
                </a>
            </div>
        </div>
    </div>

    <!-- Music Player Button Wrapper for Tooltip -->
    <div class="music-player-floating-button-wrapper">
        <button class="music-player-floating-button" id="toggleMusicButton">
            <!-- Font Awesome Music icon -->
            <i class="fas fa-music" id="musicPlayPauseIcon"></i>
        </button>
        <div class="music-tooltip" id="musicTooltip">
            <!-- Album cover image -->
            <img id="albumCover" src="" alt="Album Cover">
            <div class="music-tooltip-content">
                <span class="song-title" id="songTitle"></span>
                <span class="song-details" id="songDetails"></span>
            </div>
        </div>
    </div>

    <!-- Hidden Audio Player -->
    <audio id="audioPlayer" src="" preload="auto"></audio>

    <script>
        // --- Music Player Logic for Background Playback ---
        // These variables need to be declared globally or within the DOMContentLoaded scope
        let audioPlayer;
        let toggleMusicButton;
        let musicPlayPauseIcon;
        let musicTooltip;
        let albumCoverImg;
        let songTitleSpan;
        let songDetailsSpan;

        const SONGS = [
            {
                id: 'song1',
                title: "Die for you",
                artist: "joji",
                album: "SMITHEREENS",
                url: "music/03. Die For You.mp3",
                albumArtUrl: "albumcover/smithereens.jpeg"
            },
            {
                id: 'song2',
                title: "You suck Charlie",
                artist: "joji",
                album: "Chloe Burbank",
                url: "music/you suck charlie.m4a",
                albumArtUrl: "albumcover/chloe burbank.jpg"
            },
            {
                id: 'song3',
                title: "Come Thru",
                artist: "Joji",
                album: "BALLADS 1",
                url: "music/09 Come Thru.mp3",
                albumArtUrl: "albumcover/ballads1.png"
            }
        ];

        let currentSongIndex = -1; // No song selected initially

        function saveMusicState() {
            const currentSongId = audioPlayer.dataset.currentSongId;
            if (currentSongId) {
                const state = {
                    songId: currentSongId,
                    currentTime: audioPlayer.currentTime,
                    isPlaying: !audioPlayer.paused,
                    volume: audioPlayer.volume
                };
                localStorage.setItem('musicPlayerState', JSON.stringify(state));
            } else {
                localStorage.removeItem('musicPlayerState');
            }
        }

        function loadMusicState() {
            const savedState = localStorage.getItem('musicPlayerState');
            if (savedState) {
                const state = JSON.parse(savedState);
                const song = SONGS.find(s => s.id === state.songId);
                if (song) {
                    currentSongIndex = SONGS.indexOf(song); // Update currentSongIndex
                    audioPlayer.src = song.url;
                    audioPlayer.dataset.currentSongId = song.id;
                    audioPlayer.volume = state.volume;

                    if (state.isPlaying) {
                        audioPlayer.currentTime = state.currentTime;
                        audioPlayer.play().then(() => {
                            updateTooltip(song);
                            // The music icon is always a music note, so no play/pause icon update needed here
                            toggleMusicButton.classList.add('playing'); // Add playing class for visual feedback (e.g., pulse)
                        }).catch(error => {
                            console.log("Autoplay prevented:", error);
                            updateTooltip({
                                title: "Nhấn nút nhạc để phát!",
                                artist: "Trình duyệt đã chặn tự động phát.",
                                album: "",
                                albumArtUrl: "https://placehold.co/50x50/7f8c8d/ffffff?text=Play"
                            });
                            toggleMusicButton.classList.remove('playing');
                        });
                    } else {
                        updateTooltip(song); // Show current song info even if paused
                        audioPlayer.currentTime = state.currentTime; // Set current time even if paused
                        toggleMusicButton.classList.remove('playing');
                    }
                } else {
                    // If song not found, reset to default state
                    resetMusicState();
                }
            } else {
                // Default state if no music was previously playing
                resetMusicState();
            }
        }

        function resetMusicState() {
            currentSongIndex = -1;
            audioPlayer.src = "";
            audioPlayer.dataset.currentSongId = '';
            audioPlayer.currentTime = 0;
            audioPlayer.volume = 1; // Default volume
            localStorage.removeItem('musicPlayerState');
            updateTooltip({
                title: "Chưa có nhạc",
                artist: "Hãy chọn bài hát từ trang nhạc",
                album: "",
                albumArtUrl: "https://placehold.co/50x50/95a5a6/ffffff?text=Music"
            });
            toggleMusicButton.classList.remove('playing');
        }

        function updateTooltip(song) {
            albumCoverImg.src = song.albumArtUrl;
            albumCoverImg.alt = `Ảnh bìa album của ${song.title}`;
            songTitleSpan.textContent = song.title;
            songDetailsSpan.textContent = `${song.artist} ${song.album ? '(Album: "' + song.album + '")' : ''}`;
        }

        // --- Page Transition Logic ---
        document.addEventListener('DOMContentLoaded', () => {
            const pageContentWrapper = document.getElementById('pageContentWrapper');
            const pageLinks = document.querySelectorAll('.page-link');
            const currentTimeDisplay = document.getElementById('currentTimeDisplay'); // Get the new span for time
            const searchInput = document.getElementById('searchInput'); // Get search input
            const toolCardsGrid = document.getElementById('toolCardsGrid'); // Get the grid container
            const toolCards = toolCardsGrid.querySelectorAll('.tool-card'); // Get all tool cards
            const mainContainer = document.getElementById('mainContainer'); // Get the main container
            const derivativeIconSpan = document.getElementById('derivativeIcon'); // Get the span for derivative icon
            const animatedPlaceholderSpan = document.getElementById('animatedPlaceholder');

            let placeholderTimeout; // Declare a variable to hold the timeout ID

            // Array of math tips for the placeholder
            const mathTips = [
                "Nhân số có hai chữ số với 11.",
                "Chia nhanh cho 5.",
                "Tính phần trăm dễ dàng.",
                "Bình phương số kết thúc bằng 5.",
                "Nhân số lớn bằng phương pháp lưới.",
                "Quy tắc chia hết cho 3.",
                "Quy tắc chia hết cho 4.",
                "Quy tắc chia hết cho 6.",
                "Quy tắc chia hết cho 9.",
                "Quy tắc chia hết cho 12.",
                "Thủ thuật nhân 9.",
                "Thủ thuật nhân 12.",
                "Thủ thuật nhân 15.",
                "Thủ thuật nhân 25.",
                "Thủ thuật nhân 50.",
                "Thủ thuật nhân 100.",
                "Tìm ước chung lớn nhất.",
                "Tìm bội chung nhỏ nhất.",
                "Chuyển đổi phân số sang số thập phân.",
                "Chuyển đổi số thập phân sang phân số.",
                "Giải phương trình tuyến tính.",
                "Giải hệ phương trình.",
                "Tính diện tích hình tròn.",
                "Tính chu vi hình tròn.",
                "Tính diện tích hình vuông.",
                "Tính chu vi hình vuông.",
                "Tính diện tích hình chữ nhật.",
                "Tính chu vi hình chữ nhật.",
                "Tính diện tích tam giác.",
                "Định lý Pythagoras.",
                "Tính thể tích hình lập phương.",
                "Tính thể tích hình trụ.",
                "Tính thể tích hình cầu.",
                "Tính diện tích bề mặt hình lập phương.",
                "Tính diện tích bề mặt hình trụ.",
                "Tính diện tích bề mặt hình cầu.",
                "Quy tắc dấu ngoặc (PEMDAS/BODMAS).",
                "Giải bất phương trình.",
                "Vẽ đồ thị hàm số.",
                "Tìm nghiệm của phương trình bậc hai.",
                "Sử dụng công thức nghiệm bậc hai.",
                "Phân tích đa thức thành nhân tử.",
                "Rút gọn biểu thức đại số.",
                "Tính lũy thừa.",
                "Tính căn bậc hai.",
                "Tính logarit.",
                "Giải phương trình mũ.",
                "Giải phương trình logarit.",
                "Tính giới hạn hàm số.",
                "Tính đạo hàm cơ bản.",
                "Tính tích phân cơ bản.",
                "Quy tắc L'Hopital.",
                "Định lý giá trị trung bình.",
                "Định lý Fubini.",
                "Định lý Green.",
                "Định lý Stokes.",
                "Định lý Gauss.",
                "Ma trận nghịch đảo.",
                "Định thức của ma trận.",
                "Giải hệ phương trình bằng ma trận.",
                "Giá trị riêng, vector riêng.",
                "Phép biến đổi Laplace.",
                "Phép biến đổi Fourier.",
                "Giải phương trình vi phân.",
                "Xác suất cơ bản.",
                "Luật cộng xác suất.",
                "Luật nhân xác suất.",
                "Định lý Bayes.",
                "Phân phối chuẩn.",
                "Phân phối nhị thức.",
                "Phân phối Poisson.",
                "Kiểm định giả thuyết thống kê.",
                "Hồi quy tuyến tính.",
                "Tương quan.",
                "Độ lệch chuẩn.",
                "Phương sai.",
                "Trung bình cộng.",
                "Trung vị.",
                "Mốt.",
                "Phép cộng vector.",
                "Phép trừ vector.",
                "Tích vô hướng.",
                "Tích có hướng.",
                "Đường thẳng trong không gian.",
                "Mặt phẳng trong không gian.",
                "Hệ tọa độ cực.",
                "Hệ tọa độ trụ.",
                "Hệ tọa độ cầu.",
                "Số phức.",
                "Mô-đun và Argument của số phức.",
                "Công thức Euler.",
                "Định lý De Moivre.",
                "Chuỗi số.",
                "Hội tụ và phân kỳ của chuỗi.",
                "Chuỗi Taylor.",
                "Chuỗi Maclaurin.",
                "Phép toán modulo.",
                "Đồng dư.",
                "Số nguyên tố.",
                "Ước số.",
                "Bội số.",
                "Thuật toán Euclid.",
                "Định lý số dư Trung Quốc.",
                "Mã hóa RSA.",
                "Lý thuyết đồ thị.",
                "Đường đi Euler.",
                "Đường đi Hamilton.",
                "Cây bao trùm tối thiểu.",
                "Thuật toán Dijkstra."
            ];

            // Function to update the time display
            function updateTime() {
                const now = new Date();
                const currentHour = now.getHours();
                const currentMinute = now.getMinutes();
                const formattedMinute = currentMinute < 10 ? '0' + currentMinute : currentMinute;
                currentTimeDisplay.textContent = `${currentHour}:${formattedMinute}`;
            }

            // Update time immediately on load
            updateTime();
            // Update time every second to ensure continuous update
            setInterval(updateTime, 1000); // Changed to 1000ms (1 second)

            // Randomly set derivative icon on page load
            const derivativeIcons = ["f'(x)", "d/dx"];
            const randomIndex = Math.floor(Math.random() * derivativeIcons.length);
            derivativeIconSpan.textContent = derivativeIcons[randomIndex];

            // Set initial animated placeholder text
            const randomMathTipIndex = Math.floor(Math.random() * mathTips.length);
            animatedPlaceholderSpan.textContent = `ý tưởng: ${mathTips[randomMathTipIndex]}`;
            searchInput.placeholder = ""; // Ensure native placeholder is empty initially

            // Change placeholder after 8 seconds with animation
            placeholderTimeout = setTimeout(() => {
                animatedPlaceholderSpan.classList.add('fade-out'); // Start fade out animation

                animatedPlaceholderSpan.addEventListener('transitionend', function handler() {
                    animatedPlaceholderSpan.style.display = 'none'; // Hide after animation
                    searchInput.placeholder = "tìm kiếm về chủ đề,..."; // Set the new placeholder
                    animatedPlaceholderSpan.removeEventListener('transitionend', handler);
                }, { once: true });

            }, 8000); // 8000 milliseconds = 8 seconds


            // Animate page in on load
            pageContentWrapper.classList.add('page-transition-in');

            // Attach music player DOM elements and event listeners
            audioPlayer = document.getElementById('audioPlayer');
            toggleMusicButton = document.getElementById('toggleMusicButton');
            musicPlayPauseIcon = document.getElementById('musicPlayPauseIcon'); // This will now always be the music note icon
            musicTooltip = document.getElementById('musicTooltip');
            albumCoverImg = document.getElementById('albumCover');
            songTitleSpan = document.getElementById('songTitle');
            songDetailsSpan = document.getElementById('songDetails');

            // The click event listener for the music button now only navigates to music.html
            toggleMusicButton.addEventListener('click', (e) => {
                e.preventDefault(); // Prevent default button action
                // Add fade-out animation before navigating to music.html
                pageContentWrapper.classList.remove('page-transition-in');
                pageContentWrapper.classList.add('page-transition-out');

                // Wait for the animation to complete before navigating
                pageContentWrapper.addEventListener('animationend', () => {
                    window.location.href = 'music.html'; // Navigate to the music page
                }, { once: true });
            });

            // These event listeners for audio player state are only relevant if the button directly controls playback.
            // Since this button now navigates to music.html, these are less critical here.
            // However, to maintain the 'playing' class for the pulse effect, we keep them.
            audioPlayer.addEventListener('play', () => {
                toggleMusicButton.classList.add('playing');
                saveMusicState();
            });

            audioPlayer.addEventListener('pause', () => {
                toggleMusicButton.classList.remove('playing');
                saveMusicState();
            });

            audioPlayer.addEventListener('ended', () => {
                // This logic is primarily for the music.html page, but kept here for consistency
                // if the user returns to index.html and a song was playing/ended.
                currentSongIndex = (currentSongIndex + 1) % SONGS.length;
                audioPlayer.src = SONGS[currentSongIndex].url;
                audioPlayer.dataset.currentSongId = SONGS[currentSongIndex].id;
                updateTooltip(SONGS[currentSongIndex]);
                // audioPlayer.play(); // Do not auto-play here, let music.html handle it
                saveMusicState();
            });

            audioPlayer.addEventListener('timeupdate', saveMusicState);
            audioPlayer.addEventListener('volumechange', saveMusicState);

            loadMusicState(); // Load music state when the page loads

            // Handle page link clicks for smooth transitions
            pageLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault(); // Prevent default navigation
                    const targetPage = link.dataset.href; // Get target page from data-href

                    // Check if the link is an external link (Gemini or Copilot)
                    // External links should always open in a new tab
                    if (link.href.startsWith("http")) {
                        window.open(link.href, '_blank');
                        // No animation needed for external links, as navigation is handled by browser
                        pageContentWrapper.classList.remove('page-transition-out'); // Remove if added
                    } else {
                        // For internal links, pause music and then navigate
                        if (audioPlayer && !audioPlayer.paused) {
                            audioPlayer.pause();
                            // saveMusicState() is called by the 'pause' event listener on audioPlayer
                            // so no need to call it explicitly here.
                        }

                        // Add fade-out animation for internal links
                        pageContentWrapper.classList.remove('page-transition-in');
                        pageContentWrapper.classList.add('page-transition-out');

                        // Wait for the animation to complete before navigating for internal links
                        pageContentWrapper.addEventListener('animationend', () => {
                            window.location.href = targetPage; // Navigate to the new page
                        }, { once: true }); // Ensure the event listener is removed after it fires
                    }
                });
            });

            // Debounce function
            let debounceTimer;
            const debounce = (func, delay) => {
                return function(...args) {
                    const context = this;
                    clearTimeout(debounceTimer);
                    debounceTimer = setTimeout(() => func.apply(context, args), delay);
                };
            };

            // Function to filter tool cards
            const filterToolCards = () => {
                const searchTerm = searchInput.value.toLowerCase();

                toolCards.forEach(card => {
                    const title = card.querySelector('h2').textContent.toLowerCase();
                    const description = card.querySelector('p').textContent.toLowerCase();
                    const cardIsVisible = card.style.display !== 'none';
                    const shouldBeVisible = title.includes(searchTerm) || description.includes(searchTerm);

                    if (shouldBeVisible && !cardIsVisible) {
                        // If card should be visible but is currently hidden
                        card.style.display = 'flex'; // Make it visible for animation
                        card.classList.remove('fade-out-down'); // Remove any lingering fade-out
                        card.classList.add('fade-in-up'); // Add fade-in animation
                    } else if (!shouldBeVisible && cardIsVisible) {
                        // If card should be hidden but is currently visible
                        card.classList.remove('fade-in-up'); // Remove any lingering fade-in
                        card.classList.add('fade-out-down'); // Add fade-out animation
                        card.addEventListener('animationend', function handler() {
                            card.style.display = 'none'; // Hide after animation
                            card.classList.remove('fade-out-down'); // Clean up class
                            card.removeEventListener('animationend', handler); // Remove listener
                        }, { once: true });
                    }
                });
            };

            // Apply debounce to the search input
            searchInput.addEventListener('input', debounce(filterToolCards, 500));

            // Add/remove class to main container on search input focus/blur
            searchInput.addEventListener('focus', () => {
                mainContainer.classList.add('expanded-search');
                // Immediately hide the animated placeholder when search input is focused
                if (placeholderTimeout) {
                    clearTimeout(placeholderTimeout); // Clear the delayed change
                }
                animatedPlaceholderSpan.classList.add('fade-out'); // Start fade out animation
                animatedPlaceholderSpan.addEventListener('transitionend', function handler() {
                    animatedPlaceholderSpan.style.display = 'none'; // Hide after animation
                    searchInput.placeholder = "tìm kiếm về chủ đề,..."; // Set the new placeholder
                    animatedPlaceholderSpan.removeEventListener('transitionend', handler);
                }, { once: true });
            });

            searchInput.addEventListener('blur', () => {
                // Only collapse if the search input is empty
                if (searchInput.value.trim() === '') {
                    mainContainer.classList.remove('expanded-search');
                }
                // If there's content in the search box, it will remain expanded
            });
        });
    </script>
</body>
</html>
